<!DOCTYPE html>
<html>
<head>
	<title>Testes</title>
	<link rel="stylesheet" href="http://yui.yahooapis.com/pure/0.6.0/pure-min.css">
	<meta charset="latin1">
	<style>
		body{counter-reset: page;}
		.page h2::before{counter-increment: page; content: "#"counter(page)") ";}
		.page{counter-reset: test;}
		.test::before{counter-increment: test; content: "Teste "counter(page)"."counter(test);font-size: 14pt;font-weight: bold;}
		.test{display: table; margin-bottom: 1em; width: 50em;}
		.test > div{display: table-row;}
		.test > div > *{display: table-cell; border-top: 1px solid gray; border-left: 1px solid gray;}
		.test > div:nth-child(1) > *{border-top: 2px solid black;}
		.test > div:nth-child(2n+1) > *{background: #eee;}
		.test > div:nth-last-child(1) > *{border-bottom: 2px solid black;}
		.test > div > span:nth-child(1){width: 10em; text-align: right; padding-right: .5em; border-left: 0;}
		.field{vertical-align: top;}
 	</style>
</head>
<body>
<h1>Testes</h1>
<form class="output" action="../result/projeto.php" method="post">	
	<a class="pure-button pure-button-primary jCsv">Exportar CSV</a>
	<div class="page">
		<h2>Página Alvo: <a target="blank" href="http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;carteira&#x2F;vincular">http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;carteira&#x2F;vincular</a></h2><div>
			<div class="test">
				<div class="conditions">
					<span class="field">Condições</span>
					<ul></ul>
				</div>
				<div class="procedures">
					<span class="field">Procedimentos</span>
					<ol>
						<li>Escolher um cliente com EV livre</li>
					
						<li>Clicar em Adicionar Oportunidade de Cadastro &quot;+&quot;</li>
					
						<li>Preencher Campos e clicar em &quot;Ativar Oportunidade&quot;</li>
					</ol>
				</div>
				<div class="expected">
					<span class="field">Resultado Experado</span>
					<span>Vínculo criado com sucesso e redireciona para "http://192.168.10.33/movi/oportunidade/ver/<Número>"</span>
				</div>
				<div class="result">
					<span class="field">Resultado Obtido</span>
					<span>
						<label><input type="radio" name="result[http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;carteira&#x2F;vincular][1]" value="0">
						Falhou</label>
						<label><input type="radio" name="result[http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;carteira&#x2F;vincular][1]" value="1">
						Passou</label>
					</span>
				</div>
				<div class="comentarios">
					<span class="field">Comentários</span>
					<span><textarea name="test[http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;carteira&#x2F;vincular][1][result]" cols="80" rows="4"></textarea></span>
				</div>
			</div>

			<div class="test">
				<div class="conditions">
					<span class="field">Condições</span>
					<ul></ul>
				</div>
				<div class="procedures">
					<span class="field">Procedimentos</span>
					<ol>
						<li>Escolher um cliente com EV existente</li>
					
						<li>Clicar em Adicionar Oportunidade de Cadastro &quot;+&quot;</li>
					
						<li>Preencher Campos e clicar em &quot;Ativar Oportunidade&quot;</li>
					</ol>
				</div>
				<div class="expected">
					<span class="field">Resultado Experado</span>
					<span>Vínculo criado com sucesso e redireciona para "http://192.17.20.33/movi/oportunidade/ver/<Número>"</span>
				</div>
				<div class="result">
					<span class="field">Resultado Obtido</span>
					<span>
						<label><input type="radio" name="result[http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;carteira&#x2F;vincular][2]" value="0">
						Falhou</label>
						<label><input type="radio" name="result[http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;carteira&#x2F;vincular][2]" value="1">
						Passou</label>
					</span>
				</div>
				<div class="comentarios">
					<span class="field">Comentários</span>
					<span><textarea name="test[http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;carteira&#x2F;vincular][2][result]" cols="80" rows="4"></textarea></span>
				</div>
			</div>
		</div>
		<hr/>
	
		<h2>Página Alvo: <a target="blank" href="http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;proposta&#x2F;listar&#x2F;&lt;Número&gt;">http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;proposta&#x2F;listar&#x2F;&lt;Número&gt;</a></h2>
		<div>
			Escolha algum a partir de http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;home ou crie a partir de http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;carteira&#x2F;vincular e clique em &quot;Propostas&quot;
		</div>
		<div>
			<div class="test">
				<div class="conditions">
					<span class="field">Condições</span>
					<ul></ul>
				</div>
				<div class="procedures">
					<span class="field">Procedimentos</span>
					<ol>
						<li>Clicar em Verificar Viabilidade</li>
					
						<li>Colocar CEP de um local atendido (Por Ex: &quot;94955-490&quot;)</li>
					
						<li>Preencher Todos os Campos e clicar em &quot;Próximo&quot;</li>
					
						<li>Clicar em &quot;Analisar Viabilidade&quot;</li>
					</ol>
				</div>
				<div class="expected">
					<span class="field">Resultado Experado</span>
					<span>Aparecer a mensagem "Sucesso! Há viabilidade automática para o endereço solicitado!"</span>
				</div>
				<div class="result">
					<span class="field">Resultado Obtido</span>
					<span>
						<label><input type="radio" name="result[http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;proposta&#x2F;listar&#x2F;&lt;Número&gt;][1]" value="0">
						Falhou</label>
						<label><input type="radio" name="result[http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;proposta&#x2F;listar&#x2F;&lt;Número&gt;][1]" value="1">
						Passou</label>
					</span>
				</div>
				<div class="comentarios">
					<span class="field">Comentários</span>
					<span><textarea name="test[http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;proposta&#x2F;listar&#x2F;&lt;Número&gt;][1][result]" cols="80" rows="4"></textarea></span>
				</div>
			</div>

			<div class="test">
				<div class="conditions">
					<span class="field">Condições</span>
					<ul>
						<li> Oportunidade com pelo menos um Followups </li>
					</ul>
				</div>
				<div class="procedures">
					<span class="field">Procedimentos</span>
					<ol>
						<li>Clicar em &quot;Adicionar Proposta&quot;</li>
					
						<li>Clicar em &quot;Usar Lista de Preço&quot;</li>
					
						<li>Mensagem &quot;Adicionado com sucesso&quot;, após isso aparece o arquivo proposta####.odt para download e ele se torna visível a partir da &quot;lupa&quot; na viabilidade.</li>
					</ol>
				</div>
				<div class="expected">
					<span class="field">Resultado Experado</span>
					<span>.</span>
				</div>
				<div class="result">
					<span class="field">Resultado Obtido</span>
					<span>
						<label><input type="radio" name="result[http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;proposta&#x2F;listar&#x2F;&lt;Número&gt;][2]" value="0">
						Falhou</label>
						<label><input type="radio" name="result[http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;proposta&#x2F;listar&#x2F;&lt;Número&gt;][2]" value="1">
						Passou</label>
					</span>
				</div>
				<div class="comentarios">
					<span class="field">Comentários</span>
					<span><textarea name="test[http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;proposta&#x2F;listar&#x2F;&lt;Número&gt;][2][result]" cols="80" rows="4"></textarea></span>
				</div>
			</div>

			<div class="test">
				<div class="conditions">
					<span class="field">Condições</span>
					<ul>
						<li> Oportunidade com ZERO Followups </li>
					</ul>
				</div>
				<div class="procedures">
					<span class="field">Procedimentos</span>
					<ol>
						<li>Clicar em &quot;Adicionar Proposta&quot;</li>
					
						<li>Clicar em &quot;Usar Lista de Preço&quot;</li>
					
						<li>Preencher Campos da primeira página e clicar em &quot;Ok&quot;</li>
					</ol>
				</div>
				<div class="expected">
					<span class="field">Resultado Experado</span>
					<span>Mensagem de erro</span>
				</div>
				<div class="result">
					<span class="field">Resultado Obtido</span>
					<span>
						<label><input type="radio" name="result[http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;proposta&#x2F;listar&#x2F;&lt;Número&gt;][3]" value="0">
						Falhou</label>
						<label><input type="radio" name="result[http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;proposta&#x2F;listar&#x2F;&lt;Número&gt;][3]" value="1">
						Passou</label>
					</span>
				</div>
				<div class="comentarios">
					<span class="field">Comentários</span>
					<span><textarea name="test[http:&#x2F;&#x2F;192.168.10.33&#x2F;movi&#x2F;proposta&#x2F;listar&#x2F;&lt;Número&gt;][3][result]" cols="80" rows="4"></textarea></span>
				</div>
			</div>
		</div>
		<hr/>
	</div>
	<a class="pure-button pure-button-primary jCsv">Exportar CSV</a>
</form>
<script type="text/javascript" src="jquery-2.1.4.min.js"></script>
<script type="text/javascript" src="papaparse.js"></script>
<script type="text/javascript">
$(function() {
	$('.jCsv').click(function(event) {
		var acc = [['Condições', 'Procedimentos', 'Resultado Experado', 'Resultado Obtido', 'Comentários']];
		$('.output .test').each(function(index, elem) {
			var $elem = $(elem);
			var obtido = $elem.find('input:checked').val();
			if(obtido === '1' ){
				obtido = 'Passou';
			} else if(obtido === '0' ){
				obtido = 'Falhou';
			} else {
				obtido = '';
			}
			acc.push([$elem.find('.conditions li').toArray()
					.map(function(element){return element.textContent.trim();})
					.join('; ')+'.',
				$elem.find('.procedures li').toArray()
					.map(function(element){return element.textContent.trim();})
					.join('; ')+'.',
				$elem.find('.expected :not(.field)').text(),
				obtido,
				$elem.find('textarea').val()]);

		});
		var csv = Papa.unparse(acc, {delimiter: ';'});
		console.log(csv);
		this.download 	= 'hi.csv';
		this.href 		= 'data:text/csv;charset=utf-8,%EF%BB%BF' + encodeURIComponent(csv);//text/csv
		setTimeout(function(){
			this.href = 'about:blank';
		}.bind(this), 100);
	});
});
</script>
</body>
</html>
